pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ -500, TRUE ~ 100)) %>%
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=-2, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ -500, TRUE ~ 100)) %>%
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=0, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ -500, TRUE ~ 100)) %>%
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=1, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ -500, TRUE ~ 100)) %>%
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=-0.2, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ -500, TRUE ~ 100)) %>%
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=-0.1, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ -500, TRUE ~ 100)) %>%
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ -500, TRUE ~ 100)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=-0.1, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ -500, TRUE ~ 100)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ -0.1, TRUE ~ 0.1)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ -0.1, TRUE ~ -0.1)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ 0.3, TRUE ~ -0.1)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ 0.5, TRUE ~ -0.1)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ 1, TRUE ~ -0.1)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ 1.1, TRUE ~ -0.1)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ 1.0, TRUE ~ -0.1)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ 1.0, TRUE ~ -0.2)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ 1.1, TRUE ~ -0.2)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ 1.01, TRUE ~ -0.2)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ 1.05, TRUE ~ -0.2)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray50", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ 1.05, TRUE ~ -0.2)) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color="gray70", fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ 1.05, TRUE ~ -0.2)) %>%
mutate(color = case_when(row_number()==1 ~ "gray30", TRUE ~ "gray70")) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color=color, fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2300)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
mutate(nudge = case_when(row_number()==1 ~ 1.05, TRUE ~ -0.2)) %>%
mutate(color = case_when(row_number()==1 ~ "gray30", TRUE ~ "gray70")) %>%
with(
# ggplot
ggplot(data = .) +
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
geom_text(mapping = aes(y = location.city, x = n, label = pct, group = location.city), hjust=nudge, color=color, fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2200)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
# Format text label
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
# Define label location
mutate(nudge = case_when(row_number()==1 ~ 1.05, TRUE ~ -0.2)) %>%
# Define label color
mutate(color = case_when(row_number()==1 ~ "gray30", TRUE ~ "gray70")) %>%
# with() is required to be able to call variables with referencing to data frame
with(
# ggplot
ggplot(data = .) +
# Bars
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
# Text
geom_text(mapping = aes(y = location.city, x = n, label = pct), hjust=nudge, color=color, fontface="bold.italic") +
scale_x_continuous(limits = c(NA, 2200)) +
scale_fill_manual(values = pal_city, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
# Code & ideas borrowed heavily from CÃ‰DRIC SCHERER's personal website:
# https://www.cedricscherer.com/2021/07/05/a-quick-how-to-on-labelling-bar-graphs-in-ggplot2/
max_city_n <- 10
# pal_city <- c(rep('gray70', max_city_n-4), "coral2", "mediumpurple1", "mediumpurple1", "goldenrod1")
rest_by_city <- yelp %>%
st_set_geometry(NULL) %>%
group_by(location.city) %>%
tally() %>%
arrange(desc(n)) %>%
slice(1:max_city_n) %>%
mutate(location.city = factor(location.city, levels = .$location.city[seq(max_city_n,1)])) %>%
# Format text label
mutate(pct = scales::percent(n / sum(n),accuracy = 0.1),
pct = case_when(row_number() == 1 ~ str_c(pct, " of all businesses"), TRUE ~ pct)) %>%
# Define aesthetic properties - label location
mutate(nudge = case_when(row_number()==1 ~ 1.05, TRUE ~ -0.2)) %>%
# Define aesthetic properties - color
mutate(color = case_when(row_number()==1 ~ "gray30", TRUE ~ "gray70")) %>%
# Color palette
mutate(pal = c(rep('gray70', max_city_n-4), "coral2", "mediumpurple1", "mediumpurple1", "goldenrod1")) %>%
# with() is required to be able to call variables with referencing to data frame
with(
# ggplot
ggplot(data = .) +
# Bars
geom_col(mapping = aes(y = location.city, x = n, fill = location.city)) +
# Text
geom_text(mapping = aes(y = location.city, x = n, label = pct),
# Calling aesthetic properties defined above
hjust=nudge, color=color,
# Font styling
fontface="bold.italic") +
# Stretch x axis
scale_x_continuous(limits = c(NA, 2200)) +
# Custom palette
scale_fill_manual(values = pal, guide="none") +
labs(x = "Count", y = "Cities", title = "Top 10 cities with most restaurants in Fulton & DeKalb Counties\n") +
ggdark::dark_theme_classic()
)
rest_by_city
